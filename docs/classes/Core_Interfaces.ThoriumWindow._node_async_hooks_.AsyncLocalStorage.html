<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>AsyncLocalStorage | thoriumjs</title><meta name="description" content="Documentation for thoriumjs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">thoriumjs</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">thoriumjs</a></li><li><a href="../modules/Core_Interfaces.html">Core.Interfaces</a></li><li><a href="../interfaces/Core_Interfaces.ThoriumWindow.html">ThoriumWindow</a></li><li><a href="../modules/Core_Interfaces.ThoriumWindow._node_async_hooks_.html">&quot;node:async_hooks&quot;</a></li><li><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html">AsyncLocalStorage</a></li></ul><h1>Class AsyncLocalStorage&lt;T&gt; </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><div class="lead">
<p>This class creates stores that stay coherent through asynchronous operations.</p>
</div><div><p>While you can create your own implementation on top of the <code>async_hooks</code> module,<code>AsyncLocalStorage</code> should be preferred as it is a performant and memory safe
implementation that involves significant optimizations that are non-obvious to
implement.</p>
<p>The following example uses <code>AsyncLocalStorage</code> to build a simple logger
that assigns IDs to incoming HTTP requests and includes them in messages
logged within each request.</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">http</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;http&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">AsyncLocalStorage</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;async_hooks&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">asyncLocalStorage</span><span class="hl-1"> = </span><span class="hl-8">new</span><span class="hl-1"> </span><span class="hl-4">AsyncLocalStorage</span><span class="hl-1">();</span><br/><br/><span class="hl-8">function</span><span class="hl-1"> </span><span class="hl-4">logWithId</span><span class="hl-1">(</span><span class="hl-2">msg</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">id</span><span class="hl-1"> = </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-8">${</span><span class="hl-2">id</span><span class="hl-13"> </span><span class="hl-1">!==</span><span class="hl-13"> </span><span class="hl-8">undefined</span><span class="hl-13"> </span><span class="hl-1">?</span><span class="hl-13"> </span><span class="hl-2">id</span><span class="hl-13"> </span><span class="hl-1">:</span><span class="hl-13"> </span><span class="hl-3">&#39;-&#39;</span><span class="hl-8">}</span><span class="hl-3">:`</span><span class="hl-1">, </span><span class="hl-2">msg</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">let</span><span class="hl-1"> </span><span class="hl-2">idSeq</span><span class="hl-1"> = </span><span class="hl-7">0</span><span class="hl-1">;</span><br/><span class="hl-2">http</span><span class="hl-1">.</span><span class="hl-4">createServer</span><span class="hl-1">((</span><span class="hl-2">req</span><span class="hl-1">, </span><span class="hl-2">res</span><span class="hl-1">) </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">run</span><span class="hl-1">(</span><span class="hl-2">idSeq</span><span class="hl-1">++, () </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logWithId</span><span class="hl-1">(</span><span class="hl-3">&#39;start&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">// Imagine any chain of async operations here</span><br/><span class="hl-1">    </span><span class="hl-4">setImmediate</span><span class="hl-1">(() </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">logWithId</span><span class="hl-1">(</span><span class="hl-3">&#39;finish&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">res</span><span class="hl-1">.</span><span class="hl-4">end</span><span class="hl-1">();</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}).</span><span class="hl-4">listen</span><span class="hl-1">(</span><span class="hl-7">8080</span><span class="hl-1">);</span><br/><br/><span class="hl-2">http</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-3">&#39;http://localhost:8080&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">http</span><span class="hl-1">.</span><span class="hl-4">get</span><span class="hl-1">(</span><span class="hl-3">&#39;http://localhost:8080&#39;</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints:</span><br/><span class="hl-6">//   0: start</span><br/><span class="hl-6">//   1: start</span><br/><span class="hl-6">//   0: finish</span><br/><span class="hl-6">//   1: finish</span>
</code></pre>
<p>Each instance of <code>AsyncLocalStorage</code> maintains an independent storage context.
Multiple instances can safely exist simultaneously without risk of interfering
with each other data.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0, v12.17.0</p>
</dd></dl></div></section><section class="tsd-panel tsd-type-parameters"><h3>Type parameters</h3><ul class="tsd-type-parameters"><li><h4>T</h4></li></ul></section><section class="tsd-panel tsd-hierarchy"><h3>Hierarchy</h3><ul class="tsd-hierarchy"><li><span class="target">AsyncLocalStorage</span></li></ul></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section tsd-is-external"><h3>Constructors</h3><ul class="tsd-index-list"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#constructor" class="tsd-kind-icon">constructor</a></li></ul></section><section class="tsd-index-section tsd-is-external"><h3>Methods</h3><ul class="tsd-index-list"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#disable" class="tsd-kind-icon">disable</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#enterWith" class="tsd-kind-icon">enter<wbr/>With</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#exit" class="tsd-kind-icon">exit</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#getStore" class="tsd-kind-icon">get<wbr/>Store</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#run" class="tsd-kind-icon">run</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group tsd-is-external"><h2>Constructors</h2><section class="tsd-panel tsd-member tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a id="constructor" class="tsd-anchor"></a><h3 class="tsd-anchor-link">constructor<a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><li class="tsd-signature tsd-kind-icon">new <wbr/>Async<wbr/>Local<wbr/>Storage<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../modules/Core_Interfaces.ThoriumWindow._async_hooks_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;async_hooks&quot;</a><span class="tsd-signature-symbol">.</span><a href="Core_Interfaces.ThoriumWindow._async_hooks_.AsyncLocalStorage.html" class="tsd-signature-type" data-tsd-kind="Class">AsyncLocalStorage</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>T</h4></li></ul><h4 class="tsd-returns-title">Returns <a href="../modules/Core_Interfaces.ThoriumWindow._async_hooks_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;async_hooks&quot;</a><span class="tsd-signature-symbol">.</span><a href="Core_Interfaces.ThoriumWindow._async_hooks_.AsyncLocalStorage.html" class="tsd-signature-type" data-tsd-kind="Class">AsyncLocalStorage</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section></section><section class="tsd-panel-group tsd-member-group tsd-is-external"><h2>Methods</h2><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-external"><a id="disable" class="tsd-anchor"></a><h3 class="tsd-anchor-link">disable<a href="#disable" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-external"><li class="tsd-signature tsd-kind-icon">disable<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/async_hooks.d.ts:387</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Disables the instance of <code>AsyncLocalStorage</code>. All subsequent calls
to <code>asyncLocalStorage.getStore()</code> will return <code>undefined</code> until<code>asyncLocalStorage.run()</code> or <code>asyncLocalStorage.enterWith()</code> is called again.</p>
</div><div><p>When calling <code>asyncLocalStorage.disable()</code>, all current contexts linked to the
instance will be exited.</p>
<p>Calling <code>asyncLocalStorage.disable()</code> is required before the<code>asyncLocalStorage</code> can be garbage collected. This does not apply to stores
provided by the <code>asyncLocalStorage</code>, as those objects are garbage collected
along with the corresponding async resources.</p>
<p>Use this method when the <code>asyncLocalStorage</code> is not in use anymore
in the current process.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0, v12.17.0</p>
</dd><dt>experimental</dt><dd></dd></dl></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-external"><a id="enterWith" class="tsd-anchor"></a><h3 class="tsd-anchor-link">enter<wbr/>With<a href="#enterWith" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-external"><li class="tsd-signature tsd-kind-icon">enter<wbr/>With<span class="tsd-signature-symbol">(</span>store<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/async_hooks.d.ts:492</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Transitions into the context for the remainder of the current
synchronous execution and then persists the store through any following
asynchronous calls.</p>
</div><div><p>Example:</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">store</span><span class="hl-1"> = { </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> };</span><br/><span class="hl-6">// Replaces previous store with the given store object</span><br/><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">enterWith</span><span class="hl-1">(</span><span class="hl-2">store</span><span class="hl-1">);</span><br/><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the store object</span><br/><span class="hl-4">someAsyncOperation</span><span class="hl-1">(() </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the same object</span><br/><span class="hl-1">});</span>
</code></pre>
<p>This transition will continue for the <em>entire</em> synchronous execution.
This means that if, for example, the context is entered within an event
handler subsequent event handlers will also run within that context unless
specifically bound to another context with an <code>AsyncResource</code>. That is why<code>run()</code> should be preferred over <code>enterWith()</code> unless there are strong reasons
to use the latter method.</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">store</span><span class="hl-1"> = { </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> };</span><br/><br/><span class="hl-2">emitter</span><span class="hl-1">.</span><span class="hl-4">on</span><span class="hl-1">(</span><span class="hl-3">&#39;my-event&#39;</span><span class="hl-1">, () </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">enterWith</span><span class="hl-1">(</span><span class="hl-2">store</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><span class="hl-2">emitter</span><span class="hl-1">.</span><span class="hl-4">on</span><span class="hl-1">(</span><span class="hl-3">&#39;my-event&#39;</span><span class="hl-1">, () </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the same object</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns undefined</span><br/><span class="hl-2">emitter</span><span class="hl-1">.</span><span class="hl-4">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;my-event&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the same object</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.11.0, v12.17.0</p>
</dd><dt>experimental</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>store: <span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a id="exit" class="tsd-anchor"></a><h3 class="tsd-anchor-link">exit<a href="#exit" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><li class="tsd-signature tsd-kind-icon">exit<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>callback<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span>, <span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/async_hooks.d.ts:451</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Runs a function synchronously outside of a context and returns its
return value. The store is not accessible within the callback function or
the asynchronous operations created within the callback. Any <code>getStore()</code>call done within the callback function will always return <code>undefined</code>.</p>
</div><div><p>The optional <code>args</code> are passed to the callback function.</p>
<p>If the callback function throws an error, the error is thrown by <code>exit()</code> too.
The stacktrace is not impacted by this call and the context is re-entered.</p>
<p>Example:</p>
<pre><code class="language-js"><span class="hl-6">// Within a call to run</span><br/><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the store object or value</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">exit</span><span class="hl-1">(() </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns undefined</span><br/><span class="hl-1">    </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-8">new</span><span class="hl-1"> </span><span class="hl-9">Error</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">} </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">e</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the same object or value</span><br/><span class="hl-1">  </span><span class="hl-6">// The error will be caught here</span><br/><span class="hl-1">}</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0, v12.17.0</p>
</dd><dt>experimental</dt><dd></dd></dl></div><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>R</h4></li><li><h4>TArgs<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">[]</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>callback: <span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h5><ul class="tsd-parameters"><li class="tsd-parameter-signature"><ul class="tsd-signatures tsd-kind-type-literal tsd-is-external"><li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5><span class="tsd-flag ts-flagRest">Rest</span> <span class="tsd-signature-symbol">...</span>args: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h4></li></ul></li></ul></li><li><h5><span class="tsd-flag ts-flagRest">Rest</span> <span class="tsd-signature-symbol">...</span>args: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-is-external"><a id="getStore" class="tsd-anchor"></a><h3 class="tsd-anchor-link">get<wbr/>Store<a href="#getStore" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-is-external"><li class="tsd-signature tsd-kind-icon">get<wbr/>Store<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/async_hooks.d.ts:395</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Returns the current store.
If called outside of an asynchronous context initialized by
calling <code>asyncLocalStorage.run()</code> or <code>asyncLocalStorage.enterWith()</code>, it
returns <code>undefined</code>.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0, v12.17.0</p>
</dd></dl></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a id="run" class="tsd-anchor"></a><h3 class="tsd-anchor-link">run<a href="#run" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><li class="tsd-signature tsd-kind-icon">run<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>store<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span>, callback<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span>, <span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/async_hooks.d.ts:422</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Runs a function synchronously within a context and returns its
return value. The store is not accessible outside of the callback function or
the asynchronous operations created within the callback.</p>
</div><div><p>The optional <code>args</code> are passed to the callback function.</p>
<p>If the callback function throws an error, the error is thrown by <code>run()</code> too.
The stacktrace is not impacted by this call and the context is exited.</p>
<p>Example:</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">store</span><span class="hl-1"> = { </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-7">2</span><span class="hl-1"> };</span><br/><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">run</span><span class="hl-1">(</span><span class="hl-2">store</span><span class="hl-1">, () </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns the store object</span><br/><span class="hl-1">    </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-8">new</span><span class="hl-1"> </span><span class="hl-9">Error</span><span class="hl-1">();</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">} </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">e</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">asyncLocalStorage</span><span class="hl-1">.</span><span class="hl-4">getStore</span><span class="hl-1">(); </span><span class="hl-6">// Returns undefined</span><br/><span class="hl-1">  </span><span class="hl-6">// The error will be caught here</span><br/><span class="hl-1">}</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0, v12.17.0</p>
</dd></dl></div><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>R</h4></li><li><h4>TArgs<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">[]</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>store: <span class="tsd-signature-type" data-tsd-kind="Type parameter">T</span></h5></li><li><h5>callback: <span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h5><ul class="tsd-parameters"><li class="tsd-parameter-signature"><ul class="tsd-signatures tsd-kind-type-literal tsd-is-external"><li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">...</span>args<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5><span class="tsd-flag ts-flagRest">Rest</span> <span class="tsd-signature-symbol">...</span>args: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h4></li></ul></li></ul></li><li><h5><span class="tsd-flag ts-flagRest">Rest</span> <span class="tsd-signature-symbol">...</span>args: <span class="tsd-signature-type" data-tsd-kind="Type parameter">TArgs</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span></h4></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="../modules/Core.html">Core</a></li><li class="current tsd-kind-module"><a href="../modules/Core_Interfaces.html">Core.<wbr/>Interfaces</a></li><li class=" tsd-kind-module"><a href="../modules/Core_Models.html">Core.<wbr/>Models</a></li><li class=" tsd-kind-module"><a href="../modules/Core_Types.html">Core.<wbr/>Types</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="current tsd-kind-class tsd-parent-kind-namespace tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html" class="tsd-kind-icon">Async<wbr/>Local<wbr/>Storage</a><ul><li class="tsd-kind-constructor tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#constructor" class="tsd-kind-icon">constructor</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#disable" class="tsd-kind-icon">disable</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#enterWith" class="tsd-kind-icon">enter<wbr/>With</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#exit" class="tsd-kind-icon">exit</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#getStore" class="tsd-kind-icon">get<wbr/>Store</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._node_async_hooks_.AsyncLocalStorage.html#run" class="tsd-kind-icon">run</a></li></ul></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>