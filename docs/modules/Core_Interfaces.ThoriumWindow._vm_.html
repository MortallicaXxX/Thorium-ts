<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>&quot;vm&quot; | thoriumjs</title><meta name="description" content="Documentation for thoriumjs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">thoriumjs</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">thoriumjs</a></li><li><a href="Core_Interfaces.html">Core.Interfaces</a></li><li><a href="../interfaces/Core_Interfaces.ThoriumWindow.html">ThoriumWindow</a></li><li><a href="Core_Interfaces.ThoriumWindow._vm_.html">&quot;vm&quot;</a></li></ul><h1>Namespace &quot;vm&quot; </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><div class="lead">
<p>The <code>vm</code> module enables compiling and running code within V8 Virtual
Machine contexts. <strong>The <code>vm</code> module is not a security mechanism. Do</strong>
<strong>not use it to run untrusted code.</strong></p>
</div><div><p>JavaScript code can be compiled and run immediately or
compiled, saved, and run later.</p>
<p>A common use case is to run the code in a different V8 Context. This means
invoked code has a different global object than the invoking code.</p>
<p>One can provide the context by <code>contextifying</code> an
object. The invoked code treats any property in the context like a
global variable. Any changes to global variables caused by the invoked
code are reflected in the context object.</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">x</span><span class="hl-1"> = </span><span class="hl-7">1</span><span class="hl-1">;</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">context</span><span class="hl-1"> = { </span><span class="hl-2">x:</span><span class="hl-1"> </span><span class="hl-7">2</span><span class="hl-1"> };</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">createContext</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">); </span><span class="hl-6">// Contextify the object.</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">code</span><span class="hl-1"> = </span><span class="hl-3">&#39;x += 40; var y = 17;&#39;</span><span class="hl-1">;</span><br/><span class="hl-6">// `x` and `y` are global variables in the context.</span><br/><span class="hl-6">// Initially, x has the value 2 because that is the value of context.x.</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInContext</span><span class="hl-1">(</span><span class="hl-2">code</span><span class="hl-1">, </span><span class="hl-2">context</span><span class="hl-1">);</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">x</span><span class="hl-1">); </span><span class="hl-6">// 42</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">y</span><span class="hl-1">); </span><span class="hl-6">// 17</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">x</span><span class="hl-1">); </span><span class="hl-6">// 1; y is not defined.</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>see</dt><dd><p><a href="https://github.com/nodejs/node/blob/v16.9.0/lib/vm.js">source</a></p>
</dd></dl></div></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section tsd-is-external"><h3>Classes</h3><ul class="tsd-index-list"><li class="tsd-kind-class tsd-parent-kind-namespace tsd-is-external"><a href="../classes/Core_Interfaces.ThoriumWindow._vm_.Script.html" class="tsd-kind-icon">Script</a></li></ul></section><section class="tsd-index-section tsd-is-external"><h3>Interfaces</h3><ul class="tsd-index-list"><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.BaseOptions.html" class="tsd-kind-icon">Base<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CompileFunctionOptions.html" class="tsd-kind-icon">Compile<wbr/>Function<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-kind-icon">Context</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CreateContextOptions.html" class="tsd-kind-icon">Create<wbr/>Context<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MeasureMemoryOptions.html" class="tsd-kind-icon">Measure<wbr/>Memory<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MemoryMeasurement.html" class="tsd-kind-icon">Memory<wbr/>Measurement</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-kind-icon">Running<wbr/>Script<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.ScriptOptions.html" class="tsd-kind-icon">Script<wbr/>Options</a></li></ul></section><section class="tsd-index-section tsd-is-external"><h3>Type aliases</h3><ul class="tsd-index-list"><li class="tsd-kind-type-alias tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#MeasureMemoryMode" class="tsd-kind-icon">Measure<wbr/>Memory<wbr/>Mode</a></li></ul></section><section class="tsd-index-section tsd-is-external"><h3>Functions</h3><ul class="tsd-index-list"><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#compileFunction" class="tsd-kind-icon">compile<wbr/>Function</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#createContext" class="tsd-kind-icon">create<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#isContext" class="tsd-kind-icon">is<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#measureMemory" class="tsd-kind-icon">measure<wbr/>Memory</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInContext" class="tsd-kind-icon">run<wbr/>In<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInNewContext" class="tsd-kind-icon">run<wbr/>In<wbr/>New<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInThisContext" class="tsd-kind-icon">run<wbr/>In<wbr/>This<wbr/>Context</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group tsd-is-external"><h2>Type aliases</h2><section class="tsd-panel tsd-member tsd-kind-type-alias tsd-parent-kind-namespace tsd-is-external"><a id="MeasureMemoryMode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Measure<wbr/>Memory<wbr/>Mode<a href="#MeasureMemoryMode" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><div class="tsd-signature tsd-kind-icon">Measure<wbr/>Memory<wbr/>Mode<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;summary&quot;</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">&quot;detailed&quot;</span></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:139</li></ul></aside></section></section><section class="tsd-panel-group tsd-member-group tsd-is-external"><h2>Functions</h2><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="compileFunction" class="tsd-anchor"></a><h3 class="tsd-anchor-link">compile<wbr/>Function<a href="#compileFunction" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">compile<wbr/>Function<span class="tsd-signature-symbol">(</span>code<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, params<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-symbol">readonly </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span>, options<span class="tsd-signature-symbol">?: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CompileFunctionOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">CompileFunctionOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../interfaces/Core_Interfaces.ThoriumWindow.html#Function-1" class="tsd-signature-type" data-tsd-kind="Variable">Function</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:447</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Compiles the given code into the provided context (if no context is
supplied, the current context is used), and returns it wrapped inside a
function with the given <code>params</code>.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v10.10.0</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>code: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The body of the function to compile.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> params: <span class="tsd-signature-symbol">readonly </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An array of strings containing all parameters for the function.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CompileFunctionOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">CompileFunctionOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <a href="../interfaces/Core_Interfaces.ThoriumWindow.html#Function-1" class="tsd-signature-type" data-tsd-kind="Variable">Function</a></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="createContext" class="tsd-anchor"></a><h3 class="tsd-anchor-link">create<wbr/>Context<a href="#createContext" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">create<wbr/>Context<span class="tsd-signature-symbol">(</span>sandbox<span class="tsd-signature-symbol">?: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a>, options<span class="tsd-signature-symbol">?: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CreateContextOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">CreateContextOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:313</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>If given a <code>contextObject</code>, the <code>vm.createContext()</code> method will <code>prepare that object</code> so that it can be used in calls to <a href="Core_Interfaces.ThoriumWindow._vm_.html#runInContext">runInContext</a> or <code>script.runInContext()</code>. Inside such scripts,
the <code>contextObject</code> will be the global object, retaining all of its existing
properties but also having the built-in objects and functions any standard <a href="https://es5.github.io/#x15.1">global object</a> has. Outside of scripts run by the vm module, global variables
will remain unchanged.</p>
</div><div><pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-2">global</span><span class="hl-1">.</span><span class="hl-2">globalVar</span><span class="hl-1"> = </span><span class="hl-7">3</span><span class="hl-1">;</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">context</span><span class="hl-1"> = { </span><span class="hl-2">globalVar:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> };</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">createContext</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">);</span><br/><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInContext</span><span class="hl-1">(</span><span class="hl-3">&#39;globalVar *= 2;&#39;</span><span class="hl-1">, </span><span class="hl-2">context</span><span class="hl-1">);</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: { globalVar: 2 }</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">global</span><span class="hl-1">.</span><span class="hl-2">globalVar</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: 3</span>
</code></pre>
<p>If <code>contextObject</code> is omitted (or passed explicitly as <code>undefined</code>), a new,
empty <code>contextified</code> object will be returned.</p>
<p>The <code>vm.createContext()</code> method is primarily useful for creating a single
context that can be used to run multiple scripts. For instance, if emulating a
web browser, the method can be used to create a single context representing a
window&#39;s global object, then run all <code>&lt;script&gt;</code> tags together within that
context.</p>
<p>The provided <code>name</code> and <code>origin</code> of the context are made visible through the
Inspector API.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v0.3.1</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> sandbox: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></h5></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CreateContextOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">CreateContextOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></h4><div><p>contextified object.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="isContext" class="tsd-anchor"></a><h3 class="tsd-anchor-link">is<wbr/>Context<a href="#isContext" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">is<wbr/>Context<span class="tsd-signature-symbol">(</span>sandbox<span class="tsd-signature-symbol">: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:318</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Returns <code>true</code> if the given <code>object</code> object has been <code>contextified</code> using <a href="Core_Interfaces.ThoriumWindow._vm_.html#createContext">createContext</a>.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v0.11.7</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>sandbox: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">boolean</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="measureMemory" class="tsd-anchor"></a><h3 class="tsd-anchor-link">measure<wbr/>Memory<a href="#measureMemory" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">measure<wbr/>Memory<span class="tsd-signature-symbol">(</span>options<span class="tsd-signature-symbol">?: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MeasureMemoryOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">MeasureMemoryOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="../interfaces/Core_Interfaces.ThoriumWindow.html#Promise-1" class="tsd-signature-type" data-tsd-kind="Variable">Promise</a><span class="tsd-signature-symbol">&lt;</span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MemoryMeasurement.html" class="tsd-signature-type" data-tsd-kind="Interface">MemoryMeasurement</a><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:503</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Measure the memory known to V8 and used by all contexts known to the
current V8 isolate, or the main context.</p>
</div><div><p>The format of the object that the returned Promise may resolve with is
specific to the V8 engine and may change from one version of V8 to the next.</p>
<p>The returned result is different from the statistics returned by<code>v8.getHeapSpaceStatistics()</code> in that <code>vm.measureMemory()</code> measure the
memory reachable by each V8 specific contexts in the current instance of
the V8 engine, while the result of <code>v8.getHeapSpaceStatistics()</code> measure
the memory occupied by each heap space in the current V8 instance.</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><span class="hl-6">// Measure the memory used by the main context.</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">measureMemory</span><span class="hl-1">({ </span><span class="hl-2">mode:</span><span class="hl-1"> </span><span class="hl-3">&#39;summary&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">  </span><span class="hl-6">// This is the same as vm.measureMemory()</span><br/><span class="hl-1">  .</span><span class="hl-4">then</span><span class="hl-1">((</span><span class="hl-2">result</span><span class="hl-1">) </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// The current format is:</span><br/><span class="hl-1">    </span><span class="hl-6">// {</span><br/><span class="hl-1">    </span><span class="hl-6">//   total: {</span><br/><span class="hl-1">    </span><span class="hl-6">//      jsMemoryEstimate: 2418479, jsMemoryRange: [ 2418479, 2745799 ]</span><br/><span class="hl-1">    </span><span class="hl-6">//    }</span><br/><span class="hl-1">    </span><span class="hl-6">// }</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">result</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">context</span><span class="hl-1"> = </span><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">createContext</span><span class="hl-1">({ </span><span class="hl-2">a:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> });</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">measureMemory</span><span class="hl-1">({ </span><span class="hl-2">mode:</span><span class="hl-1"> </span><span class="hl-3">&#39;detailed&#39;</span><span class="hl-1">, </span><span class="hl-2">execution:</span><span class="hl-1"> </span><span class="hl-3">&#39;eager&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">  .</span><span class="hl-4">then</span><span class="hl-1">((</span><span class="hl-2">result</span><span class="hl-1">) </span><span class="hl-8">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// Reference the context here so that it won&#39;t be GC&#39;ed</span><br/><span class="hl-1">    </span><span class="hl-6">// until the measurement is complete.</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">context</span><span class="hl-1">.</span><span class="hl-2">a</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">// {</span><br/><span class="hl-1">    </span><span class="hl-6">//   total: {</span><br/><span class="hl-1">    </span><span class="hl-6">//     jsMemoryEstimate: 2574732,</span><br/><span class="hl-1">    </span><span class="hl-6">//     jsMemoryRange: [ 2574732, 2904372 ]</span><br/><span class="hl-1">    </span><span class="hl-6">//   },</span><br/><span class="hl-1">    </span><span class="hl-6">//   current: {</span><br/><span class="hl-1">    </span><span class="hl-6">//     jsMemoryEstimate: 2438996,</span><br/><span class="hl-1">    </span><span class="hl-6">//     jsMemoryRange: [ 2438996, 2768636 ]</span><br/><span class="hl-1">    </span><span class="hl-6">//   },</span><br/><span class="hl-1">    </span><span class="hl-6">//   other: [</span><br/><span class="hl-1">    </span><span class="hl-6">//     {</span><br/><span class="hl-1">    </span><span class="hl-6">//       jsMemoryEstimate: 135736,</span><br/><span class="hl-1">    </span><span class="hl-6">//       jsMemoryRange: [ 135736, 465376 ]</span><br/><span class="hl-1">    </span><span class="hl-6">//     }</span><br/><span class="hl-1">    </span><span class="hl-6">//   ]</span><br/><span class="hl-1">    </span><span class="hl-6">// }</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">result</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v13.10.0</p>
</dd><dt>experimental</dt><dd></dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MeasureMemoryOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">MeasureMemoryOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <a href="../interfaces/Core_Interfaces.ThoriumWindow.html#Promise-1" class="tsd-signature-type" data-tsd-kind="Variable">Promise</a><span class="tsd-signature-symbol">&lt;</span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MemoryMeasurement.html" class="tsd-signature-type" data-tsd-kind="Interface">MemoryMeasurement</a><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="runInContext" class="tsd-anchor"></a><h3 class="tsd-anchor-link">run<wbr/>In<wbr/>Context<a href="#runInContext" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">run<wbr/>In<wbr/>Context<span class="tsd-signature-symbol">(</span>code<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, contextifiedObject<span class="tsd-signature-symbol">: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a>, options<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:346</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>The <code>vm.runInContext()</code> method compiles <code>code</code>, runs it within the context of
the <code>contextifiedObject</code>, then returns the result. Running code does not have
access to the local scope. The <code>contextifiedObject</code> object <em>must</em> have been
previously <code>contextified</code> using the <a href="Core_Interfaces.ThoriumWindow._vm_.html#createContext">createContext</a> method.</p>
</div><div><p>If <code>options</code> is a string, then it specifies the filename.</p>
<p>The following example compiles and executes different scripts using a single <code>contextified</code> object:</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">contextObject</span><span class="hl-1"> = { </span><span class="hl-2">globalVar:</span><span class="hl-1"> </span><span class="hl-7">1</span><span class="hl-1"> };</span><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">createContext</span><span class="hl-1">(</span><span class="hl-2">contextObject</span><span class="hl-1">);</span><br/><br/><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-8">let</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1"> = </span><span class="hl-7">0</span><span class="hl-1">; </span><span class="hl-2">i</span><span class="hl-1"> &lt; </span><span class="hl-7">10</span><span class="hl-1">; ++</span><span class="hl-2">i</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInContext</span><span class="hl-1">(</span><span class="hl-3">&#39;globalVar *= 2;&#39;</span><span class="hl-1">, </span><span class="hl-2">contextObject</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">contextObject</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: { globalVar: 1024 }</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v0.3.1</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>code: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The JavaScript code to compile and run.</p>
</div></div></li><li><h5>contextifiedObject: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The <code>contextified</code> object that will be used as the <code>global</code> when the <code>code</code> is compiled and run.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">any</span></h4><div><p>the result of the very last statement executed in the script.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="runInNewContext" class="tsd-anchor"></a><h3 class="tsd-anchor-link">run<wbr/>In<wbr/>New<wbr/>Context<a href="#runInNewContext" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">run<wbr/>In<wbr/>New<wbr/>Context<span class="tsd-signature-symbol">(</span>code<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, contextObject<span class="tsd-signature-symbol">?: </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a>, options<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:375</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>The <code>vm.runInNewContext()</code> first contextifies the given <code>contextObject</code> (or
creates a new <code>contextObject</code> if passed as <code>undefined</code>), compiles the <code>code</code>,
runs it within the created context, then returns the result. Running code
does not have access to the local scope.</p>
</div><div><p>If <code>options</code> is a string, then it specifies the filename.</p>
<p>The following example compiles and executes code that increments a global
variable and sets a new one. These globals are contained in the <code>contextObject</code>.</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">contextObject</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-2">animal:</span><span class="hl-1"> </span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">count:</span><span class="hl-1"> </span><span class="hl-7">2</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInNewContext</span><span class="hl-1">(</span><span class="hl-3">&#39;count += 1; name = &quot;kitty&quot;&#39;</span><span class="hl-1">, </span><span class="hl-2">contextObject</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-2">contextObject</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: { animal: &#39;cat&#39;, count: 3, name: &#39;kitty&#39; }</span>
</code></pre>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v0.3.1</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>code: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The JavaScript code to compile and run.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> contextObject: <a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-signature-type" data-tsd-kind="Interface">Context</a></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>An object that will be <code>contextified</code>. If <code>undefined</code>, a new object will be created.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">any</span></h4><div><p>the result of the very last statement executed in the script.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a id="runInThisContext" class="tsd-anchor"></a><h3 class="tsd-anchor-link">run<wbr/>In<wbr/>This<wbr/>Context<a href="#runInThisContext" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><li class="tsd-signature tsd-kind-icon">run<wbr/>In<wbr/>This<wbr/>Context<span class="tsd-signature-symbol">(</span>code<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, options<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">any</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:438</li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p><code>vm.runInThisContext()</code> compiles <code>code</code>, runs it within the context of the
current <code>global</code> and returns the result. Running code does not have access to
local scope, but does have access to the current <code>global</code> object.</p>
</div><div><p>If <code>options</code> is a string, then it specifies the filename.</p>
<p>The following example illustrates using both <code>vm.runInThisContext()</code> and
the JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval"><code>eval()</code></a> function to run the same code:</p>
<pre><code class="language-js"><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><span class="hl-8">let</span><span class="hl-1"> </span><span class="hl-2">localVar</span><span class="hl-1"> = </span><span class="hl-3">&#39;initial value&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vmResult</span><span class="hl-1"> = </span><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInThisContext</span><span class="hl-1">(</span><span class="hl-3">&#39;localVar = &quot;vm&quot;;&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-3">`vmResult: &#39;</span><span class="hl-8">${</span><span class="hl-2">vmResult</span><span class="hl-8">}</span><span class="hl-3">&#39;, localVar: &#39;</span><span class="hl-8">${</span><span class="hl-2">localVar</span><span class="hl-8">}</span><span class="hl-3">&#39;`</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: vmResult: &#39;vm&#39;, localVar: &#39;initial value&#39;</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">evalResult</span><span class="hl-1"> = </span><span class="hl-4">eval</span><span class="hl-1">(</span><span class="hl-3">&#39;localVar = &quot;eval&quot;;&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-3">`evalResult: &#39;</span><span class="hl-8">${</span><span class="hl-2">evalResult</span><span class="hl-8">}</span><span class="hl-3">&#39;, localVar: &#39;</span><span class="hl-8">${</span><span class="hl-2">localVar</span><span class="hl-8">}</span><span class="hl-3">&#39;`</span><span class="hl-1">);</span><br/><span class="hl-6">// Prints: evalResult: &#39;eval&#39;, localVar: &#39;eval&#39;</span>
</code></pre>
<p>Because <code>vm.runInThisContext()</code> does not have access to the local scope,<code>localVar</code> is unchanged. In contrast,
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval"><code>eval()</code></a> <em>does</em> have access to the
local scope, so the value <code>localVar</code> is changed. In this way<code>vm.runInThisContext()</code> is much like an <a href="https://es5.github.io/#x10.4.2">indirect <code>eval()</code> call</a>, e.g.<code>(0,eval)(&#39;code&#39;)</code>.</p>

<a href="#example-running-an-http-server-within-a-vm" id="example-running-an-http-server-within-a-vm" style="color: inherit; text-decoration: none;">
  <h2>Example: Running an HTTP server within a VM</h2>
</a>
<p>When using either <code>script.runInThisContext()</code> or <a href="Core_Interfaces.ThoriumWindow._vm_.html#runInThisContext">runInThisContext</a>, the code is executed within the current V8 global
context. The code passed to this VM context will have its own isolated scope.</p>
<p>In order to run a simple web server using the <code>http</code> module the code passed to
the context must either call <code>require(&#39;http&#39;)</code> on its own, or have a reference
to the <code>http</code> module passed to it. For instance:</p>
<pre><code class="language-js"><span class="hl-3">&#39;use strict&#39;</span><span class="hl-1">;</span><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">vm</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-3">&#39;vm&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-8">const</span><span class="hl-1"> </span><span class="hl-10">code</span><span class="hl-1"> = </span><span class="hl-3">`</span><br/><span class="hl-3">((require) =&gt; {</span><br/><span class="hl-3">  const http = require(&#39;http&#39;);</span><br/><br/><span class="hl-3">  http.createServer((request, response) =&gt; {</span><br/><span class="hl-3">    response.writeHead(200, { &#39;Content-Type&#39;: &#39;text/plain&#39; });</span><br/><span class="hl-3">    response.end(&#39;Hello World</span><span class="hl-11">\\</span><span class="hl-3">n&#39;);</span><br/><span class="hl-3">  }).listen(8124);</span><br/><br/><span class="hl-3">  console.log(&#39;Server running at http://127.0.0.1:8124/&#39;);</span><br/><span class="hl-3">})`</span><span class="hl-1">;</span><br/><br/><span class="hl-2">vm</span><span class="hl-1">.</span><span class="hl-4">runInThisContext</span><span class="hl-1">(</span><span class="hl-2">code</span><span class="hl-1">)(</span><span class="hl-2">require</span><span class="hl-1">);</span>
</code></pre>
<p>The <code>require()</code> in the above case shares the state with the context it is
passed from. This may introduce risks when untrusted code is executed, e.g.
altering objects in the context in unwanted ways.</p>
</div><dl class="tsd-comment-tags"><dt>since</dt><dd><p>v0.3.1</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>code: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The JavaScript code to compile and run.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> options: <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><a href="Core_Interfaces.ThoriumWindow._vm_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&quot;vm&quot;</a><span class="tsd-signature-symbol">.</span><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-signature-type" data-tsd-kind="Interface">RunningScriptOptions</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">any</span></h4><div><p>the result of the very last statement executed in the script.</p>
</div></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="Core.html">Core</a></li><li class="current tsd-kind-module"><a href="Core_Interfaces.html">Core.<wbr/>Interfaces</a></li><li class=" tsd-kind-module"><a href="Core_Models.html">Core.<wbr/>Models</a></li><li class=" tsd-kind-module"><a href="Core_Types.html">Core.<wbr/>Types</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class tsd-parent-kind-namespace tsd-is-external"><a href="../classes/Core_Interfaces.ThoriumWindow._vm_.Script.html" class="tsd-kind-icon">Script</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.BaseOptions.html" class="tsd-kind-icon">Base<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CompileFunctionOptions.html" class="tsd-kind-icon">Compile<wbr/>Function<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.Context.html" class="tsd-kind-icon">Context</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.CreateContextOptions.html" class="tsd-kind-icon">Create<wbr/>Context<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MeasureMemoryOptions.html" class="tsd-kind-icon">Measure<wbr/>Memory<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.MemoryMeasurement.html" class="tsd-kind-icon">Memory<wbr/>Measurement</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.RunningScriptOptions.html" class="tsd-kind-icon">Running<wbr/>Script<wbr/>Options</a></li><li class="tsd-kind-interface tsd-parent-kind-namespace tsd-is-external"><a href="../interfaces/Core_Interfaces.ThoriumWindow._vm_.ScriptOptions.html" class="tsd-kind-icon">Script<wbr/>Options</a></li><li class="tsd-kind-type-alias tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#MeasureMemoryMode" class="tsd-kind-icon">Measure<wbr/>Memory<wbr/>Mode</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#compileFunction" class="tsd-kind-icon">compile<wbr/>Function</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#createContext" class="tsd-kind-icon">create<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#isContext" class="tsd-kind-icon">is<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#measureMemory" class="tsd-kind-icon">measure<wbr/>Memory</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInContext" class="tsd-kind-icon">run<wbr/>In<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInNewContext" class="tsd-kind-icon">run<wbr/>In<wbr/>New<wbr/>Context</a></li><li class="tsd-kind-function tsd-parent-kind-namespace tsd-is-external"><a href="Core_Interfaces.ThoriumWindow._vm_.html#runInThisContext" class="tsd-kind-icon">run<wbr/>In<wbr/>This<wbr/>Context</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>